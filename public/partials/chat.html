<div ng-if="ctrl.curUser" ng-controller="ChatController as chat">
  <div id="chat-messages">
    <div class="message" ng-repeat="msg in chat.receivedMessages">
      <span class="{{ chat.getUserClass(msg.user) }}">{{ msg.user + ':' }}</span>
      {{ msg.message }}
    </div>
  </div>
  <form class="chat-input" ng-submit="chat.sendMessage()">
    <input type="text" ng-model="chat.message">
    <input type="submit" value="Send">
  </form>
  <div ng-if="chat.showModal" class="modal">
    <div class="popup">
      <div class="close-popup" ng-click="chat.showModal=false">X</div>
      <div id="pl" class="preloader">
        <h4>Attempting to contact deep space scout ship...</h4>
        <img src="/images/loading.svg" alt="please wait">
      </div>
      <iframe id='ftw' scrolling="no" class="hidden" width="700px" height="720px" ng-src="{{ chat.iframeDest }}"
        onload="document.getElementById('pl').className='hidden';document.getElementById('ftw').className='ftw';">
      </iframe>
    </div>
  </div>
</div>
